
<div class="row">
  <!-- โ Sidebar: ูุงุฆูุฉ ุงูุจุงุฆุนูู -->
  <div class="col-md-3 bg-white border-end shadow-sm vh-100 p-3" style="overflow-y: auto;">
    <h4 class="text-center mb-4 text-primary fw-bold">
      <i class="fas fa-users"></i> ุงูุจุงุฆุนูู
    </h4>

    <div *ngIf="loadingSellers" class="text-center text-muted mb-3">
      <i class="fas fa-spinner fa-spin"></i> ุฌุงุฑู ุงูุชุญููู...
    </div>

    <ul *ngIf="!loadingSellers" class="list-group">
      <li *ngFor="let seller of sellers"
          class="list-group-item list-group-item-action d-flex justify-content-between align-items-start"
          (click)="selectSeller(seller)"
          [class.active]="selectedSellerSlug === seller.slug"
          style="cursor: pointer;">
        <div>
          <i class="fas fa-user-circle me-2 text-secondary"></i>
          {{ seller.name }}
          <div class="small text-muted ms-4">
            <i class="fas fa-store"></i> {{ seller.store_name }}
          </div>
        </div>
        <i *ngIf="selectedSellerSlug === seller.slug" class="fas fa-check text-success"></i>
      </li>
    </ul>
  </div>

  <!-- โ ุงููุญุชูู: ููุชุฌุงุช ุงูุจุงุฆุน ุงููุญุฏุฏ -->
  <div class="col-md-9 p-4" style="background-color: #f7f9fc;">
  <div class="row" *ngIf="sellerProducts.length > 0">
  <div class="accordion" id="productsAccordion">
    <div *ngFor="let product of sellerProducts; let i = index" class="accordion-item mb-3 shadow-sm rounded-4">
      <h2 class="accordion-header" [id]="'productHeading' + i">
        <button class="accordion-button fw-bold" type="button"
                data-bs-toggle="collapse"
                [attr.data-bs-target]="'#productCollapse' + i"
                aria-expanded="true"
                [attr.aria-controls]="'productCollapse' + i">
          ๐๏ธ {{ product.name }} - ๐ฐ {{ product.price }} ุฌ.ู
        </button>
      </h2>
      <div [id]="'productCollapse' + i" class="accordion-collapse collapse"
           [class.show]="i === 0"
           [attr.aria-labelledby]="'productHeading' + i"
           data-bs-parent="#productsAccordion">
        <div class="accordion-body">
          <p><strong>๐ ุงููุตู:</strong> {{ product.description }}</p>
          <p><strong>๐ฆ ุงููููุฉ:</strong> {{ product.quantity }}</p>
          <p><strong>๐ช ุงููุญู:</strong> {{ product.store_name }}</p>

          <!-- โ ุงูุฃููุงู -->
          <p *ngIf="product.colors?.length">
            ๐จ <strong>ุงูุฃููุงู:</strong>
            <span *ngFor="let c of product.colors" class="badge bg-primary me-1">{{ c.color }}</span>
          </p>

          <!-- โ ุงูููุงุณุงุช -->
          <p *ngIf="product.sizes?.length">
            ๐ <strong>ุงูููุงุณุงุช:</strong>
            <span *ngFor="let s of product.sizes" class="badge bg-secondary me-1">{{ s.size }}</span>
          </p>

          <!-- โ ุงูุตูุฑ -->
          <div class="images mt-3">
  <img *ngFor="let img of product.images"
       [src]="img.image_path"
       alt="Product Image"
       class="img-thumbnail me-2"
       style="height: 120px; width: auto;">
</div>

        </div>
      </div>
    </div>
  </div>
</div>

<!-- โ ุงูุทูุจุงุช ุงูุฎุงุตุฉ ุจุงูุจุงุฆุน -->
<div class="mt-5" *ngIf="selectedSellerSlug">
  <h4 class="mb-4 text-center text-dark fw-bold">
    <i class="fas fa-clipboard-list"></i> ุทูุจุงุช ุงูุจุงุฆุน
  </h4>
  <div class="mb-3">
  <label class="form-label fw-bold">ููุชุฑ ุงูุญุงูุฉ:</label>
  <select class="form-select w-auto d-inline-block"
          [(ngModel)]="selectedStatus"
          (change)="filterSellerOrders()">
    <option value="all">ุงููู</option>
    <option value="pending">ููุฏ ุงูุงูุชุธุงุฑ</option>
    <option value="processing">ููุฏ ุงููุนุงูุฌุฉ</option>
    <option value="completed">ููุชูู</option>
  </select>
</div>


  <div *ngIf="loadingOrders" class="text-center text-muted">
    <i class="fas fa-spinner fa-spin"></i> ุฌุงุฑู ุชุญููู ุงูุทูุจุงุช...
  </div>

  <div *ngIf="!loadingOrders && sellerOrders.length === 0" class="alert alert-warning text-center">
    <i class="fas fa-exclamation-circle"></i> ูุง ุชูุฌุฏ ุทูุจุงุช ููุฐุง ุงูุจุงุฆุน.
  </div>

  <div class="accordion" id="ordersAccordion" *ngIf="sellerOrders.length > 0">
    <div *ngFor="let order of sellerOrders; let i = index" class="accordion-item mb-3 shadow-sm rounded-4">
      <h2 class="accordion-header" [id]="'heading' + i">
        <button class="accordion-button fw-bold" type="button" data-bs-toggle="collapse"
                [attr.data-bs-target]="'#collapse' + i" aria-expanded="true"
                [attr.aria-controls]="'collapse' + i">
          ๐งพ ุทูุจ: {{ order.slug }} | 
          ๐ฆ <span class="badge ms-2" [ngClass]="{
  'bg-warning': order.status === 'pending',
  'bg-primary': order.status === 'processing',
  'bg-success': order.status === 'completed',
}">
  {{
    order.status === 'pending' ? 'ููุฏ ุงูุงูุชุธุงุฑ' :
    order.status === 'processing' ? 'ููุฏ ุงููุนุงูุฌุฉ' :
    order.status === 'completed' ? 'ููุชูู' :
    order.status
  }}
</span>

        </button>
      </h2>
      <div [id]="'collapse' + i" class="accordion-collapse collapse" [class.show]="i === 0"
           [attr.aria-labelledby]="'heading' + i" data-bs-parent="#ordersAccordion">
        <div class="accordion-body">
          <p><strong>๐ค ุงููุณุชุฎุฏู:</strong> {{ order.user?.name }}</p>
          <p><strong>๐ง ุงูุฅูููู:</strong> {{ order.user?.email }}</p>
          <p><strong>๐ ุงููุงุชู:</strong> {{ order.user?.phone }}</p>

          <!-- โ ุนูุงุตุฑ ุงูุทูุจ -->
          <div *ngFor="let item of order.order_items" class="mt-4 border-top pt-3">
            <h6 class="text-primary fw-bold">
              <i class="fas fa-box"></i> {{ item.order_item.name }}
              <span class="text-muted small ms-2">{{ item.order_item.description }}</span>
            </h6>

            <p>๐ต ุงูุณุนุฑ: {{ item.order_item.price }} ร {{ item.quantity }} = 
              <strong>{{ item.order_item.price * item.quantity }} ุฌ.ู</strong></p>

            <p>๐จ ุงูุฃููุงู:
              <span *ngFor="let c of item.order_item.colors" class="badge bg-primary me-1">
                {{ c.color }}
              </span>
            </p>

            <p>๐ ุงูููุงุณุงุช:
              <span *ngFor="let s of item.order_item.sizes" class="badge bg-secondary me-1">
                {{ s.size }}
              </span>
            </p>

            <div class="images mt-2">
              <img *ngFor="let img of item.order_item.images"
                   [src]="img.image_path"
                   alt="Product Image"
                   class="img-thumbnail me-2"
                   style="height: 90px; width: auto;">
            </div>
          </div>

          <!-- โ ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุก -->
          <div class="mt-4 text-end">
            <a [routerLink]="['/orders/', order.slug]" class="btn btn-outline-info me-2 ms-4">
              <i class="fas fa-eye"></i> ุนุฑุถ ุงูุชูุงุตูู
            </a>
            <button class="btn btn-outline-danger" (click)="deleteOrder(order.slug)">
              <i class="fas fa-trash"></i> ุญุฐู ุงูุทูุจ
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


    <!-- โ ูู ุญุงู ูู ูุชู ุงุฎุชูุงุฑ ุจุงุฆุน -->
    <div *ngIf="!selectedSellerSlug" class="text-center mt-5 text-muted">
      <i class="fas fa-arrow-left fa-2x mb-2"></i>&nbsp;
      <p>ุงุฎุชุฑ ุจุงุฆุนูุง ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูุนุฑุถ ููุชุฌุงุชู.</p>
    </div>
  </div>
</div>
